---
// src/components/PostCard.astro
const { title, url, date, cover } = Astro.props;

// 颜色逻辑 (保持不变)
const colors = [
  'var(--md-sys-color-primary-container)',
  'var(--md-sys-color-secondary-container)',
  'var(--md-sys-color-tertiary-container)',
  'var(--md-sys-color-error-container)',
];
const index = title.split("").reduce((acc, char) => acc + char.charCodeAt(0), 0) % colors.length;
const theme = colors[index]; // 只需要背景色
---

<a href={url} class="blog-card">
  <div class="card-image-container">
    {cover ? (
      <img src={cover} alt={title} class="card-image" />
    ) : (
      /* 关键修复：用纯 CSS 的 <span> 替换慢速加载的 <md-icon> */
      <div class="placeholder-bg" style={`background-color: ${theme};`}>
        <span class="material-symbols-rounded" style="font-size: 64px; font-weight: 300;">
          auto_stories
        </span>
        </div>
    )}
  </div>

  <div class="content">
    <h3 class="headline">{title}</h3>
    <div class="meta">{new Date(date).toLocaleDateString()}</div>
  </div>
  
  <md-ripple></md-ripple>
</a>

<script>
  import '@material/web/ripple/ripple.js';
</script>

<style>
  /* === 样式保持不变，但增加 Placeholder 的字体保障 === */
  
  .blog-card {
    display: flex; flex-direction: column; position: relative;
    background-color: var(--md-sys-color-surface);
    border-radius: 24px; overflow: hidden; height: 100%;
    transition: transform 0.2s, box-shadow 0.2s;
    text-decoration: none; color: inherit;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .blog-card:hover { transform: translateY(-4px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }

  .card-image-container {
    height: 220px; width: 100%; position: relative; overflow: hidden;
    background-color: var(--md-sys-color-surface-variant);
  }

  .card-image { width: 100%; height: 100%; object-fit: cover; display: block; }

  /* 占位容器样式 */
  .placeholder-bg {
    width: 100%; height: 100%;
    display: flex; align-items: center; justify-content: center;
    /* 确保文字颜色和背景色的对比度 */
    color: var(--md-sys-color-on-primary-container); 
  }

  .content { padding: 1.5rem; flex-grow: 1; display: flex; flex-direction: column; }
  .headline { margin: 0 0 1rem 0; font-size: 1.25rem; font-weight: 500; line-height: 1.3; }
  .meta { margin-top: auto; font-size: 0.9rem; color: var(--md-sys-color-on-surface-variant); }
</style>